:start_code
@ECHO OFF
echo Loading...
color f
title Offline Minecraft
SETLOCAL EnableExtensions EnableDelayedExpansion
if not exist %APPDATA%\.minecraft mkdir %APPDATA%\.minecraft
SET "name="
call:set
call:scan
:menu
cls
echo Offline Minecraft
echo.
echo.
echo 1) Launch the Minecraft Launcher
echo 2) Add an offline Minecraft account
echo 5) Exit
choice /c 12345 /n /m " "
if %errorlevel%==1 (goto launch)
if %errorlevel%==2 (goto add)
if %errorlevel%==5 (exit)
:add
cls
SET /P name="Add account: "
cls
echo Adding account...
call:prof
goto menu
:start
call:scan
call:prof
goto launch
:launch
cls
echo Launching...
if exist %MC_DIR% start %MC_DIR%
exit
:download_jq
echo.
echo Downloading jq
curl -o %APPDATA%\.minecraft\jq-win32.exe "https://github.com/Kotsasmin/Minecraft-launcher-data/blob/master/jq-win32.exe?raw=true" -L -s
cls
goto start_code
:download_mc
echo.
echo Downloading Minecraft Launcher
curl -o %APPDATA%\.minecraft\Minecraft.exe "https://launcher.mojang.com/download/Minecraft.exe" -L -s
cls
goto start_code
:readd
cls
echo Please type the name of your offline account.
echo.
SET /P name="Offline account: "
cls
echo Adding account...
call:prof
goto menu
:set
SET "MC_DIR=%APPDATA%\.minecraft\Minecraft.exe"
SET "SYSDIR=%SystemRoot%\System32"
SET "ATTRIB=!SYSDIR!\ATTRIB.EXE"
SET "SETTINGS=%APPDATA%\.minecraft\launcher_settings.json"
SET "PROFILES=%APPDATA%\.minecraft\launcher_profiles.json"
SET "PROFILE_ENTRY=Offline Minecraft Account | don't modify"
SET UUID=00000000000000000000000000000000
SET "JQ=%APPDATA%\.minecraft\jq-win32.exe"
SET JQ_FILE=https://github.com/Kotsasmin/Minecraft-launcher-data/blob/master/jq-win32.exe?raw=true
goto:eof
:prof
"!ATTRIB!" -R -S -H "!PROFILES!">NUL 2>&1
"!ATTRIB!" -R -S -H "!PROFILES:~,-5!">NUL 2>&1
SET "OUTPUT="
FOR /F "delims=" %%I in ('2^>NUL TYPE "!PROFILES!" ^| "!JQ!" -r ".authenticationDatabase|select(.^!=null)" 2^>NUL') do SET OUTPUT=%%I
IF "!OUTPUT!"=="" ECHO {}>"!PROFILES!" 2>NUL
TYPE "!PROFILES!" | "!JQ!" ".authenticationDatabase+={\"!name!\":{\"accessToken\":\"\",\"profiles\":{\"!UUID!\":{\"displayName\":\"!name!\"}},\"username\":\"!PROFILE_ENTRY!\"}}">"!PROFILES:~,-5!" 2>NUL
DEL "!PROFILES!">NUL 2>&1
REN "!PROFILES:~,-5!" "launcher_profiles.json">NUL 2>&1
goto:eof
:scan
if not exist %APPDATA%\.minecraft\jq-win32.exe goto download_jq
if not exist %APPDATA%\.minecraft\Minecraft.exe goto download_mc
if not exist %PROFILES% goto readd
goto:eof
